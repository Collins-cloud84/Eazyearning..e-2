<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EasyEarning-e² | Affiliate Marketing Platform</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-blue: #1a237e;
      --dark-blue: #0d1338;
      --accent-red: #e53935;
      --soft-blue: #e3e8fa;
      --card-bg: #fff;
      --sidebar-gradient: linear-gradient(180deg, #1a237e 0%, #0d1338 100%);
      --font: 'Poppins', Arial, sans-serif;
    }
    body {
      margin: 0;
      font-family: var(--font);
      background: var(--soft-blue);
      color: var(--main-blue);
      min-height: 100vh;
    }
    h1, h2, h3 {
      font-weight: 700;
      color: var(--main-blue);
      margin-bottom: 18px;
      letter-spacing: 0.5px;
    }
    /* Homepage, Registration, Login */
    .centered-container {
      max-width: 410px;
      margin: 80px auto;
      background: var(--card-bg);
      border-radius: 18px;
      padding: 36px 32px;
      box-shadow: 0 8px 32px rgba(26,35,126,0.13);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .form-card {
      background: #f6faff;
      padding: 24px 18px;
      border-radius: 12px;
      margin-bottom: 22px;
      color: var(--main-blue);
      box-shadow: 0 2px 8px rgba(26,35,126,0.07);
      width: 100%;
    }
    .payment-info {
      background: #fce4ec;
      border-left: 5px solid var(--accent-red);
      padding: 10px 18px;
      border-radius: 8px;
      margin: 18px 0;
      color: var(--accent-red);
    }
    .pay-number {
      font-weight: bold;
      font-size: 1.1em;
      color: var(--accent-red);
    }
    form label {
      display: block;
      margin-top: 18px;
      font-weight: 500;
      color: var(--main-blue);
    }
    form input, form select {
      width: 100%;
      padding: 10px 12px;
      margin-top: 6px;
      border: 2px solid var(--main-blue);
      border-radius: 8px;
      font-size: 1em;
      background: #f8fafc;
      margin-bottom: 6px;
      font-family: var(--font);
      transition: border 0.2s;
    }
    form input:focus, form select:focus {
      border-color: var(--accent-red);
      outline: none;
    }
    .btn-blue {
      background: linear-gradient(90deg, var(--main-blue) 60%, var(--accent-red) 100%);
      color: #fff;
      border: none;
      padding: 13px 30px;
      border-radius: 8px;
      font-size: 1.09em;
      font-weight: bold;
      margin-top: 18px;
      cursor: pointer;
      transition: background 0.2s;
      font-family: var(--font);
    }
    .btn-blue:hover {
      background: var(--accent-red);
      color: var(--main-blue);
    }
    .btn-blue-outline {
      background: #fff;
      color: var(--main-blue);
      border: 2px solid var(--main-blue);
      padding: 10px 24px;
      border-radius: 7px;
      font-weight: bold;
      margin-top: 12px;
      margin-right: 8px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      font-family: var(--font);
    }
    .btn-blue-outline:hover {
      background: var(--main-blue);
      color: #fff;
      border-color: var(--accent-red);
    }
    .error-msg {
      color: var(--accent-red);
      margin-top: 8px;
      font-weight: 700;
      font-size: 1em;
    }
    /* Sidebar & Main App */
    .vertical-sidebar {
      position: fixed;
      left: 0; top: 0; bottom: 0;
      width: 220px;
      background: var(--sidebar-gradient);
      color: #fff;
      box-shadow: 2px 0 12px rgba(26,35,126,0.13);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 32px;
      z-index: 10;
      min-height: 100vh;
    }
    .vertical-sidebar .logo {
      font-size: 1.7em;
      font-weight: bold;
      margin-bottom: 38px;
      letter-spacing: 1px;
      background: linear-gradient(90deg, var(--accent-red) 40%, #fff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .vertical-sidebar ul {
      list-style: none;
      padding: 0;
      width: 100%;
    }
    .vertical-sidebar ul li {
      width: 100%;
      margin-bottom: 16px;
    }
    .vertical-sidebar ul li a {
      display: block;
      padding: 16px 26px;
      color: #fff;
      text-decoration: none;
      font-size: 1.13em;
      border-radius: 8px 0 0 8px;
      transition: background 0.2s, color 0.2s;
      font-family: var(--font);
      font-weight: 500;
      letter-spacing: 0.4px;
    }
    .vertical-sidebar ul li a:hover {
      background: var(--accent-red);
      color: #fff;
    }
    .main-content {
      margin-left: 220px;
      padding: 36px 18px;
    }
    .container {
      background: var(--card-bg);
      padding: 28px 22px;
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(26,35,126,0.10);
      max-width: 740px;
      margin: 0 auto 38px auto;
    }
    /* Cards */
    .dashboard-row {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 24px;
    }
    .dashboard-card {
      flex: 1 1 260px;
      background: linear-gradient(135deg, #e3e8fa 60%, #fff 100%);
      border-radius: 14px;
      box-shadow: 0 3px 15px rgba(26,35,126,0.09);
      margin-bottom: 16px;
      padding: 22px 18px;
      display: flex;
      align-items: center;
      gap: 16px;
      min-width: 220px;
      position: relative;
    }
    .dashboard-card .card-icon {
      font-size: 2.5em;
      color: var(--accent-red);
      margin-right: 12px;
    }
    .dashboard-card strong {
      font-size: 1.11em;
      display: block;
      color: var(--main-blue);
    }
    .dashboard-card .card-label {
      color: var(--main-blue);
      font-size: 1em;
      font-weight: 500;
      margin-bottom: 5px;
    }
    .dashboard-card .card-value {
      color: var(--accent-red);
      font-size: 1.12em;
      font-weight: 700;
      margin-bottom: 2px;
    }
    .referral-card, .withdrawal-card, .leaderboard-card {
      background: linear-gradient(90deg, #fce4ec 0%, #e3e8fa 100%);
      padding: 20px 18px;
      border-radius: 12px;
      margin-bottom: 22px;
      color: var(--main-blue);
      box-shadow: 0 2px 8px rgba(26,35,126,0.10);
    }
    .earn-tabs {
      display: flex;
      gap: 14px;
      margin-bottom: 24px;
    }
    .earn-tab-content {
      margin-top: 18px;
    }
    /* Gallery images/videos */
    #photoGallery {
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }
    #photoGallery img {
      width: 210px;
      height: 140px;
      object-fit: cover;
      border-radius: 14px;
      margin-bottom: 10px;
      box-shadow: 0 3px 12px rgba(26,35,126,0.16);
      cursor: pointer;
      border: 3px solid transparent;
      transition: border 0.2s;
    }
    #photoGallery img.liked {
      border: 3px solid var(--accent-red);
      box-shadow: 0 6px 18px rgba(229,57,53,0.12);
    }
    #videoGallery {
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }
    #videoGallery video {
      width: 260px;
      height: 160px;
      border-radius: 14px;
      margin-bottom: 10px;
      box-shadow: 0 3px 12px rgba(26,35,126,0.16);
      cursor: pointer;
      border: 3px solid transparent;
      transition: border 0.2s;
      background: #222;
    }
    #videoGallery video.watched {
      border: 3px solid var(--accent-red);
      box-shadow: 0 6px 18px rgba(229,57,53,0.12);
    }
    /* Table */
    table {
      border-collapse: collapse;
      width: 100%;
    }
    table thead {
      background: linear-gradient(90deg, var(--main-blue) 60%, var(--accent-red) 100%);
      color: #fff;
    }
    table th, table td {
      padding: 12px 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      font-family: var(--font);
      font-size: 1em;
    }
    @media (max-width: 1000px) {
      .main-content { margin-left: 0; }
      .vertical-sidebar { position: relative; width: 100%; height: auto; flex-direction: row; justify-content: center; padding: 0;}
      .vertical-sidebar ul { flex-direction: row; display: flex; justify-content: center;}
      .vertical-sidebar ul li a { border-radius: 8px; margin: 0 2px;}
      .container { max-width: 97vw; }
      .dashboard-row { flex-direction: column; gap: 0; }
      #photoGallery img, #videoGallery video { width: 98vw; height: 160px;}
    }
  </style>
</head>
<body>
  <!-- Registration Page -->
  <div id="registerPage" class="centered-container">
    <h1>EasyEarning-e²</h1>
    <div class="form-card">
      <form id="registrationForm">
        <label>Username:</label>
        <input type="text" name="username" required>
        <label>Phone Number:</label>
        <input type="tel" name="phone" required>
        <label>Email:</label>
        <input type="email" name="email" required>
        <label>Password:</label>
        <input type="password" name="password" required>
        <label>Country:</label>
        <select name="country" required>
          <option value="">Select Country</option>
          <option value="Kenya">Kenya</option>
          <option value="Uganda">Uganda</option>
        </select>
        <div class="payment-info">
          <label>Registration Fee (200 KES):</label>
          <p>
            Pay <strong>200 KES</strong> to <span class="pay-number">Mpesa: 0740685187</span>.<br>
            Payment details will be provided after registration.
          </p>
        </div>
        <button type="submit" class="btn-blue">Register</button>
      </form>
      <div id="regError" class="error-msg"></div>
      <p style="margin-top:14px;">Already registered? <a href="#" onclick="showLogin()" style="color:var(--accent-red);font-weight:700;">Login here</a></p>
    </div>
  </div>
  <!-- Login Page -->
  <div id="loginPage" class="centered-container" style="display:none;">
    <h1>EasyEarning-e²</h1>
    <div class="form-card">
      <form id="loginForm">
        <label>Username:</label>
        <input type="text" name="loginUsername" required>
        <label>Password:</label>
        <input type="password" name="loginPassword" required>
        <button type="submit" class="btn-blue">Login</button>
      </form>
      <div id="loginError" class="error-msg"></div>
      <p style="margin-top:14px;">Don't have an account? <a href="#" onclick="showRegister()" style="color:var(--main-blue);font-weight:700;">Register here</a></p>
    </div>
  </div>

  <!-- Main App Sections -->
  <div id="app" style="display:none;">
    <div class="sidebar vertical-sidebar">
      <div class="logo">EasyEarning-e²</div>
      <ul>
        <li><a href="#" onclick="showSection('dashboard')">Dashboard</a></li>
        <li><a href="#" onclick="showSection('earn')">Earn</a></li>
        <li><a href="#" onclick="showSection('referral')">Referral</a></li>
        <li><a href="#" onclick="showSection('withdrawal')">Withdrawal</a></li>
        <li><a href="#" onclick="showSection('leaderboard')">Leaderboard</a></li>
        <li><a href="#" onclick="logout()">Logout</a></li>
      </ul>
    </div>
    <div class="main-content">
      <!-- Dashboard -->
      <section id="dashboard">
        <div class="container">
          <h2><span style="color:var(--accent-red);margin-right:8px;">&#128202;</span>Dashboard</h2>
          <div class="dashboard-row">
            <div class="dashboard-card">
              <span class="card-icon">&#128176;</span>
              <div>
                <div class="card-label">Total Earnings</div>
                <div class="card-value" id="totalEarnings">0 KES</div>
              </div>
            </div>
            <div class="dashboard-card">
              <span class="card-icon">&#128101;</span>
              <div>
                <div class="card-label">Referral (Lvl 1)</div>
                <div class="card-value" id="referralEarningsL1">0 KES</div>
              </div>
            </div>
            <div class="dashboard-card">
              <span class="card-icon">&#128106;</span>
              <div>
                <div class="card-label">Referral (Lvl 2)</div>
                <div class="card-value" id="referralEarningsL2">0 KES</div>
              </div>
            </div>
          </div>
          <div class="dashboard-row">
            <div class="dashboard-card">
              <span class="card-icon">&#128247;</span>
              <div>
                <div class="card-label">Photo Likes</div>
                <div class="card-value" id="likesEarnings">0 KES</div>
              </div>
            </div>
            <div class="dashboard-card">
              <span class="card-icon">&#127909;</span>
              <div>
                <div class="card-label">Video Earnings</div>
                <div class="card-value" id="videoEarnings">0 KES</div>
              </div>
            </div>
            <div class="dashboard-card">
              <span class="card-icon">&#127891;</span>
              <div>
                <div class="card-label">Trivia Earnings</div>
                <div class="card-value" id="triviaEarnings">0 KES</div>
              </div>
            </div>
          </div>
          <div class="dashboard-row">
            <div class="dashboard-card">
              <span class="card-icon">&#128273;</span>
              <div>
                <div class="card-label">Available Balance</div>
                <div class="card-value" id="availableBalance">0 KES</div>
              </div>
            </div>
            <div class="dashboard-card">
              <span class="card-icon">&#128179;</span>
              <div>
                <div class="card-label">Withdrawn</div>
                <div class="card-value" id="withdrawnBalance">0 KES</div>
              </div>
            </div>
          </div>
          <div class="dashboard-card" style="background:#fff7fa;">
            <span class="card-icon" style="color:var(--main-blue);">&#128279;</span>
            <div>
              <div class="card-label">Your Referral Link</div>
              <div style="word-break:break-all;font-size:1em;" id="referralLink">[Link]</div>
            </div>
          </div>
          <div style="margin-top:18px;color:var(--main-blue);font-size:1em;">
            Welcome, <strong id="dashboardUsername"></strong>!
          </div>
        </div>
      </section>

      <!-- Earn Section -->
      <section id="earn" style="display:none;">
        <div class="container">
          <h2><span style="color:var(--accent-red);margin-right:8px;">&#127942;</span>Earn Money</h2>
          <div class="earn-tabs">
            <button onclick="showEarnTab('photos')" class="btn-blue-outline">Like Photos</button>
            <button onclick="showEarnTab('videos')" class="btn-blue-outline">Watch Videos</button>
            <button onclick="showEarnTab('trivia')" class="btn-blue-outline">Trivia Questions</button>
          </div>
          <div id="earnPhotos" class="earn-tab-content">
            <h3 style="color:var(--main-blue);">Like Photos (5 KES/photo)</h3>
            <div id="photoGallery"></div>
          </div>
          <div id="earnVideos" class="earn-tab-content" style="display:none;">
            <h3 style="color:var(--main-blue);">Watch Videos (5 KES/video)</h3>
            <div id="videoGallery"></div>
          </div>
          <div id="earnTrivia" class="earn-tab-content" style="display:none;">
            <h3 style="color:var(--main-blue);">Trivia Questions (1 KES/correct answer)</h3>
            <div id="triviaQuestions"></div>
          </div>
        </div>
      </section>

      <!-- Referral System -->
      <section id="referral" style="display:none;">
        <div class="container">
          <h2><span style="color:var(--accent-red);margin-right:8px;">&#128279;</span>Referral System</h2>
          <div class="referral-card">
            <p>Share your referral link to earn:</p>
            <ul style="margin-bottom:18px;">
              <li><b>Level 1:</b> 100 KES per direct sign-up</li>
              <li><b>Level 2:</b> 50 KES per your downline's sign-up</li>
            </ul>
            <input type="text" id="userReferralLink" readonly style="width:80%;margin-bottom:8px;">
            <button onclick="copyReferralLink()" class="btn-blue-outline">Copy Link</button>
            <p style="margin-top:18px;">Level 1 Referrals: <span id="referralCountL1">0</span> | Earnings: <span id="referralEarningsL1_2">0 KES</span></p>
            <p>Level 2 Referrals: <span id="referralCountL2">0</span> | Earnings: <span id="referralEarningsL2_2">0 KES</span></p>
          </div>
        </div>
      </section>

      <!-- Withdrawal System -->
      <section id="withdrawal" style="display:none;">
        <div class="container">
          <h2><span style="color:var(--accent-red);margin-right:8px;">&#128179;</span>Withdraw Earnings</h2>
          <div class="withdrawal-card">
            <p>Minimum withdrawal: <strong>150 KES</strong>. Service fee: <strong>10%</strong></p>
            <form id="withdrawalForm">
              <label>Amount (KES):</label>
              <input type="number" name="amount" min="150" required>
              <label>Phone Number (for payment):</label>
              <input type="tel" name="withdrawPhone" required>
              <button type="submit" class="btn-blue">Withdraw</button>
            </form>
            <p id="withdrawalMessage"></p>
          </div>
        </div>
      </section>

      <!-- Leaderboard -->
      <section id="leaderboard" style="display:none;">
        <div class="container">
          <h2><span style="color:var(--accent-red);margin-right:8px;">&#127942;</span>Leaderboard</h2>
          <div class="leaderboard-card">
            <table>
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Username</th>
                  <th>Earnings (KES)</th>
                  <th>Referrals</th>
                </tr>
              </thead>
              <tbody id="leaderboardTable">
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </div>
  </div>
<script>
  // App state
  let registeredUser = {};
  let isLoggedIn = false;
  let user = {
    username: 'User',
    password: '',
    phone: '',
    email: '',
    country: '',
    earnings: 0,
    referralEarningsL1: 0,
    referralEarningsL2: 0,
    photoEarnings: 0,
    videoEarnings: 0,
    triviaEarnings: 0,
    referralsL1: 0,
    referralsL2: 0,
    referralLink: '',
    availableBalance: 0,
    withdrawn: 0
  };

  // Show different pages
  function showRegister() {
    document.getElementById('registerPage').style.display = 'flex';
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('app').style.display = 'none';
    document.getElementById('regError').textContent = '';
    document.getElementById('loginError').textContent = '';
  }
  function showLogin() {
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('loginPage').style.display = 'flex';
    document.getElementById('app').style.display = 'none';
    document.getElementById('regError').textContent = '';
    document.getElementById('loginError').textContent = '';
  }
  function showApp() {
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('app').style.display = 'block';
    showSection('dashboard');
    initDashboard();
  }
  function logout() {
    isLoggedIn = false;
    showLogin();
  }

  // Registration
  document.getElementById('registrationForm').onsubmit = function(e) {
    e.preventDefault();
    // Get data
    let username = this.username.value.trim();
    let password = this.password.value;
    let phone = this.phone.value.trim();
    let email = this.email.value.trim();
    let country = this.country.value;

    // Simple validation
    if (username.length < 3 || password.length < 4) {
      document.getElementById('regError').textContent = "Username must be at least 3 characters and password at least 4.";
      return;
    }
    registeredUser = {
      username,
      password,
      phone,
      email,
      country
    };
    document.getElementById('regError').textContent = "";
    showLogin();
  };

  // Login
  document.getElementById('loginForm').onsubmit = function(e) {
    e.preventDefault();
    let username = this.loginUsername.value.trim();
    let password = this.loginPassword.value;

    if (
      username === registeredUser.username &&
      password === registeredUser.password
    ) {
      isLoggedIn = true;
      user.username = registeredUser.username;
      user.password = registeredUser.password;
      user.phone = registeredUser.phone;
      user.email = registeredUser.email;
      user.country = registeredUser.country;
      user.referralLink = window.location.origin + '/?ref=' + user.username;
      showApp();
    } else {
      document.getElementById('loginError').textContent = "Invalid username or password.";
    }
  };

  // Sidebar navigation
  function showSection(sectionId) {
    const sections = document.querySelectorAll('.main-content section');
    sections.forEach(sec => sec.style.display = 'none');
    document.getElementById(sectionId).style.display = 'block';
  }

  // Earn tabs navigation
  function showEarnTab(tab) {
    document.getElementById('earnPhotos').style.display = 'none';
    document.getElementById('earnVideos').style.display = 'none';
    document.getElementById('earnTrivia').style.display = 'none';
    if (tab === 'photos') document.getElementById('earnPhotos').style.display = 'block';
    if (tab === 'videos') document.getElementById('earnVideos').style.display = 'block';
    if (tab === 'trivia') document.getElementById('earnTrivia').style.display = 'block';
  }

  // Dashboard
  function initDashboard() {
    document.getElementById('dashboardUsername').textContent = user.username;
    document.getElementById('referralLink').textContent = user.referralLink;
    document.getElementById('userReferralLink').value = user.referralLink;
    updateEarnings();
  }

  // Copy referral link
  function copyReferralLink() {
    const copyText = document.getElementById("userReferralLink");
    copyText.select();
    copyText.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("Referral link copied!");
  }

  // Earn: Photos
  const photos = [
    {src: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=700&q=80', id: 1},
    {src: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=700&q=80', id: 2},
    {src: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=700&q=80', id: 3}
  ];
  function loadPhotos() {
    const gallery = document.getElementById('photoGallery');
    gallery.innerHTML = '';
    photos.forEach(photo => {
      const img = document.createElement('img');
      img.src = photo.src;
      img.alt = 'Photo';
      img.onclick = function() {
        if (!img.classList.contains('liked')) {
          img.classList.add('liked');
          user.photoEarnings += 5;
          user.earnings += 5;
          user.availableBalance += 5;
          updateEarnings();
        }
      };
      gallery.appendChild(img);
    });
  }

  // Earn: Videos
  const videos = [
    {src: 'https://www.w3schools.com/html/mov_bbb.mp4', id: 1},
    {src: 'https://www.w3schools.com/html/movie.mp4', id: 2}
  ];
  function loadVideos() {
    const gallery = document.getElementById('videoGallery');
    gallery.innerHTML = '';
    videos.forEach(video => {
      const vid = document.createElement('video');
      vid.src = video.src;
      vid.controls = true;
      vid.poster = "https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=700&q=80";
      vid.onplay = function() {
        if (!vid.classList.contains('watched')) {
          vid.classList.add('watched');
          user.videoEarnings += 5;
          user.earnings += 5;
          user.availableBalance += 5;
          updateEarnings();
        }
      };
      gallery.appendChild(vid);
    });
  }

  // Earn: Trivia
  const trivias = [
    {question: 'What is the capital of Kenya?', answer: 'Nairobi'},
    {question: '2 + 2 = ?', answer: '4'},
    {question: 'What color is the Kenyan flag?', answer: 'Black'}
  ];
  function loadTrivia() {
    const container = document.getElementById('triviaQuestions');
    container.innerHTML = '';
    trivias.forEach((t, idx) => {
      const div = document.createElement('div');
      div.style.marginBottom = '12px';
      div.innerHTML = `
        <strong>${t.question}</strong><br>
        <input type="text" id="triviaInput${idx}" placeholder="Your answer">
        <button onclick="submitTrivia(${idx})" class="btn-blue-outline">Submit</button>
        <span id="triviaResult${idx}"></span>
      `;
      container.appendChild(div);
    });
  }
  function submitTrivia(idx) {
    const input = document.getElementById('triviaInput'+idx);
    const result = document.getElementById('triviaResult'+idx);
    if (input.value.trim().toLowerCase() === trivias[idx].answer.toLowerCase()) {
      result.textContent = "✔ Correct! (+1 KES)";
      result.style.color = "#36cfc9";
      user.triviaEarnings += 1;
      user.earnings += 1;
      user.availableBalance += 1;
      updateEarnings();
    } else {
      result.textContent = "✘ Incorrect";
      result.style.color = "#e53935";
    }
    input.disabled = true;
  }

  // Simulate referral earnings
  function addReferral(level) {
    if (level === 1) {
      user.referralsL1 += 1;
      user.referralEarningsL1 += 100;
      user.earnings += 100;
      user.availableBalance += 100;
    } else if (level === 2) {
      user.referralsL2 += 1;
      user.referralEarningsL2 += 50;
      user.earnings += 50;
      user.availableBalance += 50;
    }
    updateEarnings();
  }

  // Update earnings in dashboard and referral section
  function updateEarnings() {
    document.getElementById('totalEarnings').textContent = user.earnings + " KES";
    document.getElementById('referralEarningsL1').textContent = user.referralEarningsL1 + " KES";
    document.getElementById('referralEarningsL2').textContent = user.referralEarningsL2 + " KES";
    document.getElementById('likesEarnings').textContent = user.photoEarnings + " KES";
    document.getElementById('videoEarnings').textContent = user.videoEarnings + " KES";
    document.getElementById('triviaEarnings').textContent = user.triviaEarnings + " KES";
    document.getElementById('availableBalance').textContent = user.availableBalance + " KES";
    document.getElementById('withdrawnBalance').textContent = user.withdrawn + " KES";
    document.getElementById('referralEarningsL1_2').textContent = user.referralEarningsL1 + " KES";
    document.getElementById('referralEarningsL2_2').textContent = user.referralEarningsL2 + " KES";
    document.getElementById('referralCountL1').textContent = user.referralsL1;
    document.getElementById('referralCountL2').textContent = user.referralsL2;
  }

  // Withdrawal
  document.getElementById('withdrawalForm').onsubmit = function(e) {
    e.preventDefault();
    const amt = parseFloat(this.amount.value);
    if (amt < 150) {
      document.getElementById('withdrawalMessage').textContent = "Minimum withdrawal is 150 KES.";
      document.getElementById('withdrawalMessage').style.color = "#e53935";
      return;
    }
    if (amt > user.availableBalance) {
      document.getElementById('withdrawalMessage').textContent = "Insufficient balance.";
      document.getElementById('withdrawalMessage').style.color = "#e53935";
      return;
    }
    const fee = Math.round(amt * 0.10);
    const finalAmt = amt - fee;
    user.availableBalance -= amt;
    user.withdrawn += finalAmt;
    updateEarnings();
    document.getElementById('withdrawalMessage').textContent =
      `Withdrawal successful! You will receive ${finalAmt} KES after 10% fee (${fee} KES).`;
    document.getElementById('withdrawalMessage').style.color = "#36cfc9";
    this.reset();
  };

  // Leaderboard (dummy data)
  const leaderboard = [
    {username: 'Alice', earnings: 900, referrals: 20},
    {username: 'Bob', earnings: 850, referrals: 15},
    {username: 'Charlie', earnings: 800, referrals: 12},
    {username: 'You', earnings: 0, referrals: 0}
  ];
  function loadLeaderboard() {
    const table = document.getElementById('leaderboardTable');
    table.innerHTML = '';
    leaderboard[3].earnings = user.earnings;
    leaderboard[3].referrals = user.referralsL1 + user.referralsL2;
    leaderboard.sort((a, b) => b.earnings - a.earnings);
    leaderboard.forEach((u, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${i+1}</td>
        <td>${u.username}</td>
        <td>${u.earnings} KES</td>
        <td>${u.referrals}</td>
      `;
      table.appendChild(tr);
    });
  }

  // Initial load
  window.onload = function() {
    showRegister();
    loadPhotos();
    loadVideos();
    loadTrivia();
    loadLeaderboard();
  };
</script>
</body>
</html>